// Configuration
$desktop-columns: 12 !default; // the number of columns in your grid
$tablet-columns: 12 !default; // the number of columns in your grid
$handheld-columns: 12 !default; // the number of columns in your grid

$gutter-width: 10 !default;
$max-desktop-width: 1140px + $gutter-width !default;
$max-tablet-landscape-width: 960px + $gutter-width !default;
$max-tablet-width: 768px + $gutter-width !default;
$max-handheld-landscape-width: 420px + $gutter-width !default;
$max-handheld-width: 300px + $gutter-width !default;

// Utility variables â€” you should never need to modify these
// Handheld
$column-h-width: (($max-handheld-width - $gutter-width) - ($gutter-width * $handheld-columns)) / $handheld-columns;
$grid-h-width: ($column-h-width*$handheld-columns) + ($gutter-width*$handheld-columns);
// Handheld Landscape
$column-hl-width: (($max-handheld-landscape-width - $gutter-width) - ($gutter-width * $handheld-columns)) / $handheld-columns;
$grid-hl-width: ($column-hl-width*$handheld-columns) + ($gutter-width*$handheld-columns);
// Tablet
$column-t-width: (($max-tablet-width - $gutter-width) - ($gutter-width * $tablet-columns)) / $tablet-columns;
$grid-t-width: ($column-t-width*$tablet-columns) + ($gutter-width*$tablet-columns);
// Tablet Landscape
$column-tl-width: (($max-tablet-landscape-width - $gutter-width) - ($gutter-width * $tablet-columns)) / $tablet-columns;
$grid-tl-width: ($column-tl-width*$tablet-columns) + ($gutter-width*$tablet-columns);
// Desktop
$column-d-width: (($max-desktop-width - $gutter-width) - ($gutter-width * $desktop-columns)) / $desktop-columns;
$grid-d-width: ($column-d-width*$desktop-columns) + ($gutter-width*$desktop-columns);

$total-h-width:  $grid-h-width;
$total-hl-width: $grid-hl-width;
$total-t-width:  $grid-t-width;
$total-tl-width: $grid-tl-width;
$total-d-width:  $grid-d-width;

@mixin row($columns:$desktop-columns,$total-width:$total-d-width,$grid-width:$grid-d-width) {
	width: $total-width*(($gutter-width + $grid-width)/$grid-width) - $gutter-width;
}

@mixin column($columns:$desktop-columns,$total-width:$total-d-width,$column-width:$column-d-width,$grid-width:$grid-d-width) {
	width: $total-width*(((($gutter-width+$column-width)*$columns)-$gutter-width) / $grid-width);
}

@mixin offset($offset:1,$total-width:$total-d-width,$column-width:$column-d-width,$grid-width:$grid-d-width) {
	margin-left: ($total-width*(((($gutter-width+$column-width)*$offset)-$gutter-width) / $grid-width)) + ($total-width*(($gutter-width)/$grid-width));
}

body{}
#page {
	width: $max-handheld-width;
	margin: 0 auto;
}

// Create the Columns and Rows
$_allColumns: "";
$_allRows: "";
@for $col from 1 to ($handheld-columns + 1) {
	@if $_allColumns == "" {
		$_allColumns: ".g-h-#{$col}";
	} @else {
		$_allColumns: $_allColumns + ", .g-h-#{$col}";
	}
	@if $_allColumns == "" {
		$_allColumns: ".g-hl-#{$col}";
	} @else {
		$_allColumns: $_allColumns + ", .g-hl-#{$col}";
	}
	@if $_allRows == "" {
		$_allRows: ".g-h-r#{$col}";
	} @else {
		$_allRows: $_allRows + ", .g-h-r#{$col}";
	}
	@if $_allRows == "" {
		$_allRows: ".g-hl-r#{$col}";
	} @else {
		$_allRows: $_allRows + ", .g-hl-r#{$col}";
	}
}

@for $col from 1 to ($tablet-columns + 1) {
	@if $_allColumns == "" {
		$_allColumns: ".g-t-#{$col}";
	} @else {
		$_allColumns: $_allColumns + ", .g-t-#{$col}";
	}
	@if $_allColumns == "" {
		$_allColumns-t: ".g-tl-#{$col}";
	} @else {
		$_allColumns: $_allColumns + ", .g-tl-#{$col}";
	}
	@if $_allRows == "" {
		$_allRows: ".g-t-r#{$col}";
	} @else {
		$_allRows: $_allRows + ", .g-t-r#{$col}";
	}
	@if $_allRows == "" {
		$_allRows-t: ".g-tl-r#{$col}";
	} @else {
		$_allRows: $_allRows + ", .g-tl-r#{$col}";
	}
}

@for $col from 1 to ($desktop-columns + 1) {
	@if $_allColumns == "" {
		$_allColumns: ".g-d-#{$col}";
	} @else {
		$_allColumns: $_allColumns + ", .g-d-#{$col}";
	}
	@if $_allRows == "" {
		$_allRows: ".g-d-r#{$col}";
	} @else {
		$_allRows: $_allRows + ", .g-d-r#{$col}";
	}
}

#{$_allColumns} {
	@include box-sizing(border-box);
	display: inline;
	float: left;
	overflow: hidden;
	margin-left: $gutter-width*.5;
	margin-right: $gutter-width*.5;
}

#{$_allRows}, .row {
	@include clearfix();
}

#{$_allRows} {
	margin-right: (($gutter-width*.5)*-1);
	margin-left: (($gutter-width*.5)*-1);
}

.row {
	margin-right: (($gutter-width*.5)*1);
	margin-left: (($gutter-width*.5)*1);
}

// Generate nested row classes for handheld media
@for $col from 1 to ($handheld-columns + 1) {
	.g-h-r#{$col} {
	@include row($col,$total-h-width,$grid-h-width);
	}
}

// Generate column classes for handheld media
@for $col from 1 to ($handheld-columns + 1) {
	.g-h-#{$col} {
	@include column($col,$total-h-width,$column-h-width,$grid-h-width);
	}
}

// Generate offset column classes for handheld media
@for $col from 1 to ($handheld-columns + 1) {
	.g-h-o#{$col} {
	@include offset($col,$total-h-width,$column-h-width,$grid-h-width);
	}
}

.row {
	@include row($tablet-columns,$total-h-width,$grid-h-width);
	@if $show-grid-background {
		$grid-background-total-columns: $handheld-columns;
		$grid-background-offset: 4px;
		$grid-background-column-width: $column-h-width;
		$grid-background-gutter-width: $gutter-width;
		$grid-background-baseline-height: $base-line-height;
		@include grid-background;
	}
}

// Handheld Landscape
@media only screen and (min-width: 480px) {
	body {}
	#page {
	width: $max-handheld-landscape-width;
	}

	// Disables iphone font size increase when viewing in landscape mode.
	html { -webkit-text-size-adjust: none; }
	body {}

	.row {
		@include row($tablet-columns,$total-hl-width,$grid-hl-width);
		@if $show-grid-background {
			$grid-background-total-columns: $handheld-columns;
			$grid-background-offset: 4px;
			$grid-background-column-width: $column-hl-width;
			$grid-background-gutter-width: $gutter-width;
			$grid-background-baseline-height: $base-line-height;
			@include grid-background;
		}
	}

	// Generate nested row classes for handheld-landscape media
	@for $col from 1 to ($handheld-columns + 1) {
		.g-hl-r#{$col} {
		@include row($col,$total-hl-width,$grid-hl-width);
		}
	}

	// Generate column classes for handheld-landscape media
	@for $col from 1 to ($handheld-columns + 1) {
		.g-hl-#{$col} {
		@include column($col,$total-hl-width,$column-hl-width,$grid-hl-width);
		}
	}

	// Generate offset column classes for handheld-landscape media
	@for $col from 1 to ($handheld-columns + 1) {
		.g-hl-o#{$col} {
		@include offset($col,$total-hl-width,$column-hl-width,$grid-hl-width);
		}
	}

}

// Tablet Portrait
@media only screen and (min-width: 768px) {
	body{}
	#page {
	width: $max-tablet-width;
	}

	.row {
		@include row($tablet-columns,$total-t-width,$grid-t-width);
		@if $show-grid-background {
			$grid-background-total-columns: $tablet-columns;
			$grid-background-offset: 4px;
			$grid-background-column-width: $column-t-width;
			$grid-background-gutter-width: $gutter-width;
			$grid-background-baseline-height: $base-line-height;
			@include grid-background;
		}
	}

	// Generate nested row classes for tablet portrait media
	@for $col from 1 to ($tablet-columns + 1) {
		.g-t-r#{$col} {
		@include row($col,$total-t-width,$grid-t-width);
		}
	}

	// Generate column classes for tablet portrait media
	@for $col from 1 to ($tablet-columns + 1) {
		.g-t-#{$col} {
		@include column($col,$total-t-width,$column-t-width,$grid-t-width);
		}
	}

	// Generate offset column classes for tablet portrait media
	@for $col from 1 to ($tablet-columns + 1) {
		.g-t-o#{$col} {
		@include offset($col,$total-t-width,$column-t-width,$grid-t-width);
		}
	}

}

// Tablet Landscape
@media only screen and (min-width: 960px) {
	body{}
	#page {
	width: $max-tablet-landscape-width;
	}

	.row {
		@include row($tablet-columns,$total-tl-width,$grid-tl-width);
		@if $show-grid-background {
			$grid-background-total-columns: $tablet-columns;
			$grid-background-offset: 4px;
			$grid-background-column-width: $column-tl-width;
			$grid-background-gutter-width: $gutter-width;
			$grid-background-baseline-height: $base-line-height;
			@include grid-background;
		}
	}

	// Generate nested row classes for tablet landscape media
	@for $col from 1 to ($tablet-columns + 1) {
		.g-tl-r#{$col} {
		@include row($col,$total-tl-width,$grid-tl-width);
		}
	}

	// Generate column classes for tablet landscape media
	@for $col from 1 to ($tablet-columns + 1) {
		.g-tl-#{$col} {
		@include column($col,$total-tl-width,$column-tl-width,$grid-tl-width);
		}
	}

	// Generate offset column classes for tablet landscape media
	@for $col from 1 to ($tablet-columns + 1) {
		.g-tl-o#{$col} {
		@include offset($col,$total-tl-width,$column-tl-width,$grid-tl-width);
		}
	}

}

// Desktop
@media only screen and (min-width: 1160px) {
	body{}
	#page {
	width: $max-desktop-width;
	}

	.row {
		@include row($desktop-columns,$total-d-width,$grid-d-width);
		@if $show-grid-background {
			$grid-background-total-columns: $desktop-columns;
			$grid-background-offset: 4px;
			$grid-background-column-width: $column-d-width;
			$grid-background-gutter-width: $gutter-width;
			$grid-background-baseline-height: $base-line-height;
			@include grid-background;
		}
	}

	// Generate row classes for desktop media
	@for $col from 1 to ($desktop-columns + 1) {
		.g-d-r#{$col} {
		@include row($col,$total-d-width,$grid-d-width);
		}
	}

	// Generate column classes for desktop media
	@for $col from 1 to ($desktop-columns + 1) {
		.g-d-#{$col} {
		@include column($col,$total-d-width,$column-d-width,$grid-d-width);
		}
	}

	// Generate offset column classes for desktop media
	@for $col from 1 to ($desktop-columns + 1) {
		.g-d-o#{$col} {
		@include offset($col,$total-d-width,$column-d-width,$grid-d-width);
		}
	}

}

